<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- We need a doctype to allow us to use special characters like &nbsp; 
     We use a "strict" DTD to make IE follow the alignment rules. -->
     
<html xmlns:t="http://tapestry.apache.org/schema/tapestry_5_4.xsd">
<body class="container">
    <div class="eg">
    
        <table id="personsTable" class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>
                        <table class="inner">
                            <thead>
                                <tr>
                                    <th>Id</th>
                                    <th>First Name</th>
                                    <th>Last Name</th>
                                    <th>Region</th>
                                    <th>Start Date</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                        </table>
                    </th>
                </tr>
            </thead>
            <tbody>
                <t:Loop t:source="persons" t:value="person">
                    <tr t:type="zone" t:id="rowZone" id="prop:currentRowZoneId">
                        <td>
                            <t:form t:id="personForm" context="person.id" async="true" validate="person">
                                <table class="inner">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <span t:type="any">${person.id}</span>

                                                <!-- If optimistic locking is not needed then comment out this next line. -->
                                                <t:hidden value="person.version"/>
                                            </td>
                                            <td>
                                                <t:if test="!editing">
                                                    ${person.firstName}
                                                </t:if>
                                                <t:if test="editing">
                                                    <t:textfield t:id="firstName" value="person.firstName"/>
                                                </t:if>
                                            </td>
                                            <td>
                                                ${person.lastName}

                                                <!-- We shadow each output-only with a hidden field to enable redisplay of the list exactly as it was submitted. -->
                                                <t:hidden value="person.lastName"/>
                                            </td>
                                            <td>
                                                <t:if test="!editing">
                                                    ${personRegion}
                                                </t:if>
                                                <t:if test="editing">
                                                    <t:select t:id="region" value="person.region"/>
                                                </t:if>
                                            </td>
                                            <td>
                                                <t:if test="!editing">
                                                    <t:output t:value="person.startDate" t:format="prop:dateFormat"/>
                                                </t:if>
                                                <t:if test="editing">
                                                    <t:datefield t:id="startDate" value="person.startDate" format="prop:dateFormat"/>
                                                </t:if>
                                            </td>
                                            <td>
                                                <t:if test="!editing">
                                                    <t:eventlink event="toEdit" context="person.id" async="true" class="btn btn-default">Edit</t:eventlink>
                                                </t:if>
                                                <t:if test="editing">
                                                    <t:submit t:id="save" value="Save"/>
                                                    <t:eventlink event="cancel" context="person.id" async="true" class="btn btn-default">Cancel</t:eventlink>
                                                </t:if>
                                            </td>
                                        </tr>
                                        <t:if test="personFormHasErrors">
                                            <tr>
                                                <td colspan="6">
                                                    <t:errors globalOnly="true"/>
                                                </td>
                                            </tr>
                                        </t:if>
                                    </tbody>
                                </table>
                            </t:form>
                        </td>
                    </tr>
                </t:Loop>
            </tbody>
        </table>

    </div>
</body>
</html>
